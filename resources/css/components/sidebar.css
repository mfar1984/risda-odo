/* Sidebar Component Styles */
@layer components {
    .sidebar {
        @apply fixed left-0 top-0 h-full bg-white text-gray-800 transition-all duration-300 z-30;
        border-right: 1px solid #e5e7eb;
        margin-right: -1px;
    }
    
    .sidebar-expanded {
        @apply w-64;
        z-index: 30;
    }
    
    .sidebar-collapsed {
        @apply w-16;
        z-index: 5000 !important;
    }
    
    /* Center icons when sidebar is collapsed */
    .sidebar-collapsed .sidebar-nav-item {
        @apply justify-center px-0;
    }
    
    .sidebar-collapsed .sidebar-nav-icon {
        @apply mx-auto;
    }
    
    /* Hide blue line indicator when collapsed */
    .sidebar-collapsed .sidebar-nav-item-active::after,
    .sidebar-collapsed .sidebar-nav-item-inactive:hover::after,
    .sidebar-collapsed .sidebar-nav-item-parent-active:hover::after {
        display: none !important;
    }
    
    /* Alpine.js x-show will handle hiding/showing of both submenu types */
    
    /* Floating submenu when collapsed - Let Alpine.js x-show handle display */
    .sidebar-collapsed .submenu-dropdown {
        @apply absolute left-16 top-0 bg-white border border-gray-200 shadow-lg rounded-sm;
        min-width: 200px;
        max-height: 80vh;
        overflow-y: auto;
        z-index: 4500 !important;
        list-style: none !important;
        /* NO display: none here! Let Alpine.js x-show control it fully */
    }
    
    .sidebar-collapsed .submenu-dropdown .submenu-item {
        @apply px-4 py-2 text-sm;
        border-radius: 0 !important;
        display: block !important;
        list-style: none !important;
    }
    
    /* Hide all bullets/dots in collapsed floating menu */
    .sidebar-collapsed .submenu-dropdown::before,
    .sidebar-collapsed .submenu-dropdown::after,
    .sidebar-collapsed .submenu-dropdown .submenu-item::before,
    .sidebar-collapsed .submenu-dropdown .submenu-item::after {
        display: none !important;
        content: none !important;
    }
    
    .sidebar-header {
        @apply px-4 py-6 border-b border-gray-200;
        height: 82px;
        box-sizing: border-box;
    }
    
    .sidebar-toggle {
        @apply p-2 rounded-sm text-gray-500 hover:text-gray-800 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-300;
        @apply transition-all duration-200;
        width: 32px;
        height: 32px;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .sidebar-toggle .material-icons,
    .sidebar-toggle .material-icons-outlined {
        @apply transition-colors duration-200;
        font-size: 20px;
        line-height: 1;
    }
    
    .sidebar-nav {
        @apply px-0;
    }

    .sidebar-nav-item {
        @apply flex items-center px-4 py-2 text-sm font-medium transition-colors duration-150;
        font-size: 12px;
        border-radius: 0;
        margin: 0;
    }
    
    .sidebar-nav-item-active {
        @apply text-gray-800 relative;
        background-color: #dbeafe !important;
    }

    .sidebar-nav-item-active::after {
        content: '';
        position: absolute;
        right: 0;
        top: 0;
        bottom: 0;
        width: 3px;
        background-color: #3b82f6;
    }

    .sidebar-nav-item-inactive {
        @apply text-gray-600 relative;
        transition: all 0.2s ease;
    }

    .sidebar-nav-item-inactive:hover {
        background-color: #f0f9ff !important;
        color: #3b82f6 !important;
    }

    .sidebar-nav-item-inactive:hover .sidebar-nav-icon {
        color: #3b82f6 !important;
    }

    .sidebar-nav-item-inactive:hover::after {
        content: '' !important;
        position: absolute !important;
        right: 0 !important;
        top: 0 !important;
        bottom: 0 !important;
        width: 3px !important;
        background-color: #93c5fd !important;
        z-index: 10 !important;
    }

    /* Parent menu with submenu - no active background */
    .sidebar-nav-item-parent-active {
        @apply text-gray-800 relative;
        background-color: transparent !important;
    }

    .sidebar-nav-item-parent-active::after {
        display: none !important;
    }

    .sidebar-nav-item-parent-active:hover {
        background-color: #f0f9ff !important;
        color: #3b82f6 !important;
    }

    .sidebar-nav-item-parent-active:hover .sidebar-nav-icon {
        color: #3b82f6 !important;
    }

    .sidebar-nav-item-parent-active:hover::after {
        content: '' !important;
        position: absolute !important;
        right: 0 !important;
        top: 0 !important;
        bottom: 0 !important;
        width: 3px !important;
        background-color: #93c5fd !important;
        z-index: 10 !important;
    }
    
    .sidebar-nav-icon {
        @apply mr-3 h-5 w-5 flex-shrink-0;
    }

    /* Submenu tree lines */
    .submenu-container {
        position: relative;
        margin-left: 24px;
        margin-top: 4px;
        /* Alpine.js x-show will control display, this is just fallback */
    }

    .submenu-container::before {
        content: '';
        position: absolute;
        left: -12px;
        top: 0;
        bottom: 0;
        width: 1px;
        background-color: #d1d5db;
    }
    
    /* Ensure submenu-dropdown has proper default styling too */
    .submenu-dropdown {
        /* Alpine.js x-show will control display */
    }

    .submenu-item {
        position: relative;
        padding-left: 20px;
        z-index: 1;
    }

    .submenu-item::before {
        content: '';
        position: absolute;
        left: -12px;
        top: 50%;
        width: 18px;
        height: 1px;
        background-color: #d1d5db;
        z-index: 1;
    }

    .submenu-item::after {
        content: '';
        position: absolute;
        left: 0px;
        top: 50%;
        transform: translateY(-50%);
        width: 6px;
        height: 6px;
        background-color: #9ca3af;
        border-radius: 50%;
        z-index: 2;
    }

    /* Submenu hover and active states */
    .submenu-item.sidebar-nav-item-inactive:hover {
        background-color: #f0f9ff !important;
        color: #3b82f6 !important;
    }

    .submenu-item.sidebar-nav-item-inactive:hover::after {
        display: none;
    }

    .submenu-item.sidebar-nav-item-active {
        background-color: #dbeafe !important;
    }

    .submenu-item.sidebar-nav-item-active::after {
        display: none;
    }
    
    /* Main content adjustment */
    .main-content {
        @apply transition-all duration-300;
    }
    
    .main-content-expanded {
        @apply ml-64;
    }
    
    .main-content-collapsed {
        @apply ml-16;
    }
    
    /* ========================================
       MOBILE MENU CSS (max-width: 768px)
       Desktop CSS di atas TIDAK terjejas!
       ======================================== */
    @media (max-width: 768px) {
        /* Sidebar - Hidden by default, slide in from left */
        .sidebar {
            @apply transform -translate-x-full;
            width: 280px !important; /* Full width for mobile */
            z-index: 9001 !important; /* Above overlay (8999) and content */
            box-shadow: 2px 0 8px rgba(0, 0, 0, 0.15);
            position: fixed !important;
            left: 0 !important;
            top: 0 !important;
            bottom: 0 !important;
            height: 100vh !important;
        }
        
        /* Sidebar open state - slide in */
        .sidebar.sidebar-mobile-open {
            @apply translate-x-0;
            transform: translateX(0) !important;
        }
        
        /* Force expanded width on mobile (no collapsed state) */
        .sidebar-expanded,
        .sidebar-collapsed {
            width: 280px !important;
        }
        
        /* Hide toggle button on mobile */
        .sidebar-toggle {
            display: none !important;
        }
        
        /* Main content - NO margin on mobile */
        .main-content-expanded,
        .main-content-collapsed {
            @apply ml-0;
        }
        
        /* Overlay backdrop when menu is open */
        .sidebar-overlay {
            @apply fixed inset-0 bg-gray-600 bg-opacity-75;
            z-index: 9000 !important; /* Just below sidebar (9001) */
        }
        
        /* Sidebar header - simple header for mobile */
        .sidebar-header {
            @apply px-4 py-4;
            height: auto !important;
        }
        
        /* Menu items - larger touch targets */
        .sidebar-nav-item {
            padding: 0.875rem 1rem !important; /* 14px vertical, 16px horizontal */
            font-size: 13px !important;
            min-height: 44px !important; /* iOS recommended touch target */
        }
        
        /* Icons - slightly larger for visibility */
        .sidebar-nav-icon {
            width: 22px !important;
            height: 22px !important;
            margin-right: 0.875rem !important;
        }
        
        /* Submenu container - show vertical line */
        .submenu-container {
            margin-left: 2rem !important; /* 32px indent */
            margin-top: 0 !important;
        }
        
        .submenu-container::before {
            left: -1rem !important; /* Adjust line position */
        }
        
        /* Submenu items - touch-friendly */
        .submenu-item {
            padding: 0.75rem 1rem !important; /* 12px vertical */
            padding-left: 1.5rem !important; /* 24px indent */
            font-size: 12px !important;
            min-height: 42px !important;
        }
        
        .submenu-item::before {
            left: -1rem !important; /* Horizontal line */
            width: 16px !important;
        }
        
        .submenu-item::after {
            left: 2px !important; /* Bullet position */
        }
        
        /* Hide floating dropdown styles on mobile */
        .sidebar-collapsed .submenu-dropdown {
            position: relative !important;
            left: 0 !important;
            top: 0 !important;
            border: none !important;
            box-shadow: none !important;
            background: transparent !important;
            min-width: auto !important;
            max-height: none !important;
            overflow-y: visible !important;
            z-index: auto !important;
        }
        
        /* Force show submenus inline on mobile (no floating) */
        .sidebar-collapsed .submenu-dropdown .submenu-item {
            padding: 0.75rem 1rem !important;
            padding-left: 1.5rem !important;
        }
        
        /* Ensure submenu arrows/icons are visible */
        .sidebar-nav-item svg {
            flex-shrink: 0;
        }
        
        /* Separator - keep visible */
        .sidebar-separator {
            margin-top: 0.75rem !important;
            margin-bottom: 0.75rem !important;
        }
        
        /* Scrollable menu area */
        .sidebar-nav {
            overflow-y: auto !important;
            max-height: calc(100vh - 82px) !important; /* Full height minus header */
            -webkit-overflow-scrolling: touch; /* Smooth scrolling on iOS */
        }
        
        /* Active state - more prominent on mobile */
        .sidebar-nav-item-active {
            background-color: #dbeafe !important;
            border-left: 4px solid #3b82f6 !important;
            padding-left: calc(1rem - 4px) !important;
        }
        
        .sidebar-nav-item-active::after {
            display: none !important; /* Use left border instead */
        }
        
        /* Hover states - optimize for touch */
        .sidebar-nav-item-inactive:hover::after,
        .sidebar-nav-item-parent-active:hover::after {
            display: none !important; /* No hover effects on touch devices */
        }
        
        /* Parent menu when submenu is open */
        .sidebar-nav-item-parent-active {
            background-color: #f9fafb !important;
        }
    }

    /* Sidebar Separator Styles */
    .sidebar-separator {
        @apply my-3 px-3;
    }

    .sidebar-separator-line {
        @apply border-0 border-t border-gray-200;
        margin: 0;
        height: 1px;
        background-color: #e5e7eb;
    }
}
